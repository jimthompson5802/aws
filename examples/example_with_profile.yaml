# Example YAML specification with AWS profile support
# This file demonstrates how to specify an AWS profile for authentication

# Optional: AWS profile to use for authentication
# If not specified, will use default credentials from environment variables
profile: "my-aws-profile"  # Replace with your AWS profile name

instances:
  - name: "web-server-with-profile"
    instance_type: "t3.micro"
    ami_id: "ami-0c02fb55956c7d316"  # Amazon Linux 2 AMI (update for your region)
    market_type: "on-demand"
    key_name: "my-key-pair"  # Optional: EC2 Key Pair name
    security_groups:  # Optional: Security Group IDs
      - "sg-12345678"
    subnet_id: "subnet-12345678"  # Optional: Subnet ID
    tags:  # Optional: Custom tags
      - Key: "Environment"
        Value: "production"
      - Key: "Project"
        Value: "web-app"
      - Key: "Profile"
        Value: "demo"
    user_data:  # Optional: User data script for instance customization
      inline_script: |
        #!/bin/bash
        yum update -y
        yum install -y httpd
        systemctl start httpd
        systemctl enable httpd
        
        # Create a simple web page
        cat > /var/www/html/index.html << 'EOF'
        <!DOCTYPE html>
        <html>
        <head>
            <title>AWS Profile Demo</title>
        </head>
        <body>
            <h1>Hello from AWS!</h1>
            <p>This instance was created using AWS profile authentication.</p>
            <p>Created on: $(date)</p>
        </body>
        </html>
        EOF
        
        echo "Web server setup completed!"
    volumes:  # Optional: Additional EBS volumes
      - size: 10
        type: "gp3"
        device: "/dev/sdf"
        encrypted: true

  - name: "app-server-with-profile"
    instance_type: "t3.small"
    ami_id: "ami-0c02fb55956c7d316"
    market_type: "spot"
    spot_price: "0.02"
    key_name: "my-key-pair"
    security_groups:
      - "sg-87654321"
    tags:
      - Key: "Environment"
        Value: "development"
      - Key: "Role"
        Value: "application"
    user_data:
      script_path: "examples/python_web_server.sh"
    volumes:
      - size: 20
        type: "gp3"
        device: "/dev/sdf"
        encrypted: true
